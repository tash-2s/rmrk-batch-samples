This is a port of my one-time script and not tested. So please check it carefully before using it.
